<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>portability/file_system.hpp</title>
<meta http-equiv="generator" content="ccolour C++ colouriser by Andy Rushton">
</head>
<body lang="en">
<h1>portability/file_system.hpp</h1>
<pre style="background-color: #ffffff">
<span style="color: #ff0099">    1: </span><span style="color: #990000">#ifndef</span> <span style="color: #000000">STLPLUS_FILE_SYSTEM</span>
<span style="color: #ff0099">    2: </span><span style="color: #990000">#define</span> <span style="color: #000000">STLPLUS_FILE_SYSTEM</span>
<span style="color: #ff0099">    3: </span><span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">    4: </span>
<span style="color: #ff0099">    5: </span><span style="color: #000099">//   Author:    Andy Rushton</span>
<span style="color: #ff0099">    6: </span><span style="color: #000099">//   Copyright: (c) Southampton University 1999-2004</span>
<span style="color: #ff0099">    7: </span><span style="color: #000099">//              (c) Andy Rushton           2004-2009</span>
<span style="color: #ff0099">    8: </span><span style="color: #000099">//   License:   BSD License, see ../docs/license.html</span>
<span style="color: #ff0099">    9: </span>
<span style="color: #ff0099">   10: </span><span style="color: #000099">//   Simplified access to the File system</span>
<span style="color: #ff0099">   11: </span>
<span style="color: #ff0099">   12: </span><span style="color: #000099">//   All file system access and filename manipulation should be done</span>
<span style="color: #ff0099">   13: </span><span style="color: #000099">//   with this package. Then it is only necessary to port this package</span>
<span style="color: #ff0099">   14: </span><span style="color: #000099">//   to port all file handling.</span>
<span style="color: #ff0099">   15: </span>
<span style="color: #ff0099">   16: </span><span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">   17: </span><span style="color: #990000">#include</span> <span style="color: #009900">"portability_fixes.hpp"</span>
<span style="color: #ff0099">   18: </span><span style="color: #990000">#include</span> <span style="color: #009900">&lt;string&gt;</span>
<span style="color: #ff0099">   19: </span><span style="color: #990000">#include</span> <span style="color: #009900">&lt;vector&gt;</span>
<span style="color: #ff0099">   20: </span><span style="color: #990000">#include</span> <span style="color: #009900">&lt;time.h&gt;</span>
<span style="color: #ff0099">   21: </span><span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">   22: </span>
<span style="color: #ff0099">   23: </span><span style="color: #990000">namespace</span> <span style="color: #000000">stlplus</span>
<span style="color: #ff0099">   24: </span><span style="color: #330033">{</span>
<span style="color: #ff0099">   25: </span>
<span style="color: #ff0099">   26: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">   27: </span>  <span style="color: #000099">// implement string comparison of paths - Unix is case-sensitive, Windows is case-insensitive</span>
<span style="color: #ff0099">   28: </span>
<span style="color: #ff0099">   29: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">path_compare</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">l</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">r</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   30: </span>
<span style="color: #ff0099">   31: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">   32: </span>  <span style="color: #000099">// classifying functions</span>
<span style="color: #ff0099">   33: </span>
<span style="color: #ff0099">   34: </span>  <span style="color: #000099">// test for whether there's something (i.e. folder or file) with this name</span>
<span style="color: #ff0099">   35: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">is_present</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">thing</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   36: </span>  <span style="color: #000099">// test for whether there's something present and its a folder</span>
<span style="color: #ff0099">   37: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">is_folder</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">thing</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   38: </span>  <span style="color: #000099">// test for whether there's something present and its a file</span>
<span style="color: #ff0099">   39: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">is_file</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">thing</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   40: </span>
<span style="color: #ff0099">   41: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">   42: </span>  <span style="color: #000099">// file functions</span>
<span style="color: #ff0099">   43: </span>
<span style="color: #ff0099">   44: </span>  <span style="color: #000099">// tests whether there's a file of this name</span>
<span style="color: #ff0099">   45: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">file_exists</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   46: </span>  <span style="color: #000099">// tests whether the file is readable - i.e. exists and has read mode set</span>
<span style="color: #ff0099">   47: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">file_readable</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   48: </span>  <span style="color: #000099">// tests whether file is writable - either it exists and is writable or doesn't exist but is in a writable folder</span>
<span style="color: #ff0099">   49: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">file_writable</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   50: </span>  <span style="color: #000099">// the size of the file in bytes - 0 if doesn't exist</span>
<span style="color: #ff0099">   51: </span>  <span style="color: #000000">size_t</span> <span style="color: #000000">file_size</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   52: </span>  <span style="color: #000099">// delete the file - returns true if the delete succeeded</span>
<span style="color: #ff0099">   53: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">file_delete</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   54: </span>  <span style="color: #000099">// rename the file - returns true if the rename succeeded</span>
<span style="color: #ff0099">   55: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">file_rename</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">old_filespec</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">new_filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   56: </span>  <span style="color: #000099">// make an exact copy of the file - returns true if it succeeded</span>
<span style="color: #ff0099">   57: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">file_copy</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">old_filespec</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">new_filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   58: </span>  <span style="color: #000099">// move the file - tries to rename, if that fails, tries to copy - returns true if either of these succeeded</span>
<span style="color: #ff0099">   59: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">file_move</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">old_filespec</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">new_filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   60: </span>
<span style="color: #ff0099">   61: </span>  <span style="color: #000099">// get the file's time stamps as a time_t - see the stlplus time.hpp package</span>
<span style="color: #ff0099">   62: </span>
<span style="color: #ff0099">   63: </span>  <span style="color: #000099">// time the file was originally created</span>
<span style="color: #ff0099">   64: </span>  <span style="color: #000000">time_t</span> <span style="color: #000000">file_created</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   65: </span>  <span style="color: #000099">// time the file was last modified</span>
<span style="color: #ff0099">   66: </span>  <span style="color: #000000">time_t</span> <span style="color: #000000">file_modified</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   67: </span>  <span style="color: #000099">// time the file was accessed</span>
<span style="color: #ff0099">   68: </span>  <span style="color: #000000">time_t</span> <span style="color: #000000">file_accessed</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   69: </span>
<span style="color: #ff0099">   70: </span>  <span style="color: #000099">// platform-specific string handling to combine a directory and filename into a path</span>
<span style="color: #ff0099">   71: </span>
<span style="color: #ff0099">   72: </span>  <span style="color: #000099">// combine a folder with a filename (basename.extension)</span>
<span style="color: #ff0099">   73: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">create_filespec</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filename</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   74: </span>  <span style="color: #000099">// combine a folder, a basename and an extension - extension does not need the .</span>
<span style="color: #ff0099">   75: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">create_filespec</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">basename</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">extension</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   76: </span>  <span style="color: #000099">// combine a basename and an extension - extension does not need the .</span>
<span style="color: #ff0099">   77: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">create_filename</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">basename</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">extension</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   78: </span>
<span style="color: #ff0099">   79: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">   80: </span>  <span style="color: #000099">// folder functions</span>
<span style="color: #ff0099">   81: </span>
<span style="color: #ff0099">   82: </span>  <span style="color: #000099">// craete a folder - returns true if successful</span>
<span style="color: #ff0099">   83: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">folder_create</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   84: </span>  <span style="color: #000099">// tests for whether the folder exists, i.e. there is something of that name and its a folder</span>
<span style="color: #ff0099">   85: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">folder_exists</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   86: </span>  <span style="color: #000099">// test whether the folder contents are readable</span>
<span style="color: #ff0099">   87: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">folder_readable</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   88: </span>  <span style="color: #000099">// tests whether the folder can be written to - for example to create a new file</span>
<span style="color: #ff0099">   89: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">folder_writable</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   90: </span>  <span style="color: #000099">// delete the folder, optionally deleting the contents first - only succeeds if everything could be deleted</span>
<span style="color: #ff0099">   91: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">folder_delete</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">bool</span> <span style="color: #000000">recurse</span> <span style="color: #330033">=</span> <span style="color: #990000">false</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   92: </span>  <span style="color: #000099">// rename the folder - this probably only works within a disk/partition</span>
<span style="color: #ff0099">   93: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">folder_rename</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">old_directory</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">new_directory</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   94: </span>  <span style="color: #000099">// test whether the folder is empty (of files)</span>
<span style="color: #ff0099">   95: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">folder_empty</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   96: </span>
<span style="color: #ff0099">   97: </span>  <span style="color: #000099">// set the current folder</span>
<span style="color: #ff0099">   98: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">folder_set_current</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   99: </span>
<span style="color: #ff0099">  100: </span>  <span style="color: #000099">// platform-specific string handling to retrieve some special locations</span>
<span style="color: #ff0099">  101: </span>  <span style="color: #000099">// these do not check whether the folder exists, they just process strings</span>
<span style="color: #ff0099">  102: </span>
<span style="color: #ff0099">  103: </span>  <span style="color: #000099">// get the current folder</span>
<span style="color: #ff0099">  104: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_current</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  105: </span>  <span style="color: #000099">// get the current folder as a full path</span>
<span style="color: #ff0099">  106: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_current_full</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  107: </span>  <span style="color: #000099">// get the home folder - $HOME or %HOMEDRIVE%%HOMEPATH%</span>
<span style="color: #ff0099">  108: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_home</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  109: </span>  <span style="color: #000099">// go down a level in the folder hierarchy</span>
<span style="color: #ff0099">  110: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_down</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">subfolder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  111: </span>  <span style="color: #000099">// go up a level in the folder hierarchy</span>
<span style="color: #ff0099">  112: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_up</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span> <span style="color: #000000">levels</span> <span style="color: #330033">=</span> <span style="color: #993399">1</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  113: </span>
<span style="color: #ff0099">  114: </span>  <span style="color: #000099">// get folder contents</span>
<span style="color: #ff0099">  115: </span>
<span style="color: #ff0099">  116: </span>  <span style="color: #000099">// the set of all subdirectories</span>
<span style="color: #ff0099">  117: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">folder_subdirectories</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  118: </span>  <span style="color: #000099">// the set of all files</span>
<span style="color: #ff0099">  119: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">folder_files</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  120: </span>  <span style="color: #000099">// the set of all folders and files</span>
<span style="color: #ff0099">  121: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">folder_all</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  122: </span>  <span style="color: #000099">// the set of all folder contents matching a wildcard string</span>
<span style="color: #ff0099">  123: </span>  <span style="color: #000099">// if folders is true, include folders; if files is true, include files</span>
<span style="color: #ff0099">  124: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">folder_wildcard</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span>
<span style="color: #ff0099">  125: </span>                                           <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">wildcard</span><span style="color: #330033">,</span>
<span style="color: #ff0099">  126: </span>                                           <span style="color: #990000">bool</span> <span style="color: #000000">folders</span> <span style="color: #330033">=</span> <span style="color: #990000">true</span><span style="color: #330033">,</span>
<span style="color: #ff0099">  127: </span>                                           <span style="color: #990000">bool</span> <span style="color: #000000">files</span> <span style="color: #330033">=</span> <span style="color: #990000">true</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  128: </span>
<span style="color: #ff0099">  129: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  130: </span>  <span style="color: #000099">// path functions</span>
<span style="color: #ff0099">  131: </span>
<span style="color: #ff0099">  132: </span>  <span style="color: #000099">// string manipulations of paths</span>
<span style="color: #ff0099">  133: </span>
<span style="color: #ff0099">  134: </span>  <span style="color: #000099">// test whether a string represents a full path or a relative one</span>
<span style="color: #ff0099">  135: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">is_full_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">path</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  136: </span>  <span style="color: #990000">bool</span> <span style="color: #000000">is_relative_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">path</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  137: </span>
<span style="color: #ff0099">  138: </span>  <span style="color: #000099">// convert to a full path relative to the root path</span>
<span style="color: #ff0099">  139: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_to_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">root</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  140: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">filespec_to_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">root</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  141: </span>
<span style="color: #ff0099">  142: </span>  <span style="color: #000099">// convert to a full path relative to the current working directory</span>
<span style="color: #ff0099">  143: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_to_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  144: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">filespec_to_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  145: </span>
<span style="color: #ff0099">  146: </span>  <span style="color: #000099">// convert to a relative path relative to the root path</span>
<span style="color: #ff0099">  147: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_to_relative_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">root</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  148: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">filespec_to_relative_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">root</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  149: </span>
<span style="color: #ff0099">  150: </span>  <span style="color: #000099">// convert to a relative path relative to the current working directory</span>
<span style="color: #ff0099">  151: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_to_relative_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  152: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">filespec_to_relative_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  153: </span>
<span style="color: #ff0099">  154: </span>  <span style="color: #000099">// append a folder separator to the path to make it absolutely clear that it is a folder</span>
<span style="color: #ff0099">  155: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_append_separator</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  156: </span>
<span style="color: #ff0099">  157: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  158: </span>  <span style="color: #000099">// access functions split a filespec into its elements</span>
<span style="color: #ff0099">  159: </span>
<span style="color: #ff0099">  160: </span>  <span style="color: #000099">// get the basename - that is, the name of the file without folder or extension parts</span>
<span style="color: #ff0099">  161: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">basename_part</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  162: </span>  <span style="color: #000099">// get the filename - that is, the name of the file without folder part but with extension</span>
<span style="color: #ff0099">  163: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">filename_part</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  164: </span>  <span style="color: #000099">// get the extension - that is the part of the filename after the . (and excluding the .)</span>
<span style="color: #ff0099">  165: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">extension_part</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  166: </span>  <span style="color: #000099">// get the folder part - that is the filespec with the filename removed</span>
<span style="color: #ff0099">  167: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_part</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  168: </span>
<span style="color: #ff0099">  169: </span>  <span style="color: #000099">// split a path into a vector of elements - i.e. split at the folder separator</span>
<span style="color: #ff0099">  170: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">folder_elements</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  171: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">filespec_elements</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  172: </span>
<span style="color: #ff0099">  173: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  174: </span>  <span style="color: #000099">// Path lookup functions</span>
<span style="color: #ff0099">  175: </span>
<span style="color: #ff0099">  176: </span><span style="color: #990000">#ifdef</span> <span style="color: #000000">MSWINDOWS</span>
<span style="color: #ff0099">  177: </span><span style="color: #990000">#define</span> <span style="color: #000000">PATH_SPLITTER</span> <span style="color: #009900">";"</span>
<span style="color: #ff0099">  178: </span><span style="color: #990000">#else</span>
<span style="color: #ff0099">  179: </span><span style="color: #990000">#define</span> <span style="color: #000000">PATH_SPLITTER</span> <span style="color: #009900">":"</span>
<span style="color: #ff0099">  180: </span><span style="color: #990000">#endif</span>
<span style="color: #ff0099">  181: </span>
<span style="color: #ff0099">  182: </span>  <span style="color: #000099">// The lookup normally carried out by the shell to find a command in a</span>
<span style="color: #ff0099">  183: </span>  <span style="color: #000099">// directory in the PATH. Give this function the name of a command and it</span>
<span style="color: #ff0099">  184: </span>  <span style="color: #000099">// will return the full path. It returns an empty string on failure.</span>
<span style="color: #ff0099">  185: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">path_lookup</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">command</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  186: </span>
<span style="color: #ff0099">  187: </span>  <span style="color: #000099">// Generalised form of the above, takes a second argument</span>
<span style="color: #ff0099">  188: </span>  <span style="color: #000099">// - the list to search. This can be used to do other path lookups,</span>
<span style="color: #ff0099">  189: </span>  <span style="color: #000099">// such as LD_LIBRARY_PATH. The third argument specifies the splitter -</span>
<span style="color: #ff0099">  190: </span>  <span style="color: #000099">// the default value of PATH_SPLITTER is appropriate for environment variables.</span>
<span style="color: #ff0099">  191: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">lookup</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">file</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">path</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">splitter</span> <span style="color: #330033">=</span> <span style="color: #000000">PATH_SPLITTER</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  192: </span>
<span style="color: #ff0099">  193: </span>  <span style="color: #000099">// utility function for finding the folder that contains the current executable</span>
<span style="color: #ff0099">  194: </span>  <span style="color: #000099">// the argument is the argv[0] parameter passed to main</span>
<span style="color: #ff0099">  195: </span>  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">install_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">argv0</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  196: </span>
<span style="color: #ff0099">  197: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  198: </span>
<span style="color: #ff0099">  199: </span><span style="color: #330033">}</span> <span style="color: #000099">// end namespace stlplus</span>
<span style="color: #ff0099">  200: </span>
<span style="color: #ff0099">  201: </span><span style="color: #990000">#endif</span>
</pre>
</body>
</html>
