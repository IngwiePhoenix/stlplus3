<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>containers/digraph.hpp</title>
<meta http-equiv="generator" content="ccolour C++ colouriser by Andy Rushton">
</head>
<body lang="en">
<h1>containers/digraph.hpp</h1>
<pre style="background-color: #ffffff">
<span style="color: #ff0099">    1: </span><span style="color: #990000">#ifndef</span> <span style="color: #000000">STLPLUS_DIGRAPH</span>
<span style="color: #ff0099">    2: </span><span style="color: #990000">#define</span> <span style="color: #000000">STLPLUS_DIGRAPH</span>
<span style="color: #ff0099">    3: </span><span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">    4: </span>
<span style="color: #ff0099">    5: </span><span style="color: #000099">//   Author:    Andy Rushton</span>
<span style="color: #ff0099">    6: </span><span style="color: #000099">//   Copyright: (c) Southampton University 1999-2004</span>
<span style="color: #ff0099">    7: </span><span style="color: #000099">//              (c) Andy Rushton           2004-2009</span>
<span style="color: #ff0099">    8: </span><span style="color: #000099">//   License:   BSD License, see ../docs/license.html</span>
<span style="color: #ff0099">    9: </span>
<span style="color: #ff0099">   10: </span><span style="color: #000099">//   STL-style Directed graph template component</span>
<span style="color: #ff0099">   11: </span><span style="color: #000099">//   Digraph stands for directed-graph, i.e. all arcs have a direction</span>
<span style="color: #ff0099">   12: </span>
<span style="color: #ff0099">   13: </span><span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">   14: </span><span style="color: #990000">#include</span> <span style="color: #009900">"containers_fixes.hpp"</span>
<span style="color: #ff0099">   15: </span><span style="color: #990000">#include</span> <span style="color: #009900">"safe_iterator.hpp"</span>
<span style="color: #ff0099">   16: </span><span style="color: #990000">#include</span> <span style="color: #009900">"exceptions.hpp"</span>
<span style="color: #ff0099">   17: </span><span style="color: #990000">#include</span> <span style="color: #009900">&lt;vector&gt;</span>
<span style="color: #ff0099">   18: </span><span style="color: #990000">#include</span> <span style="color: #009900">&lt;map&gt;</span>
<span style="color: #ff0099">   19: </span><span style="color: #990000">#include</span> <span style="color: #009900">&lt;set&gt;</span>
<span style="color: #ff0099">   20: </span>
<span style="color: #ff0099">   21: </span><span style="color: #990000">namespace</span> <span style="color: #000000">stlplus</span>
<span style="color: #ff0099">   22: </span><span style="color: #330033">{</span>
<span style="color: #ff0099">   23: </span>
<span style="color: #ff0099">   24: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">   25: </span>  <span style="color: #000099">// Internals</span>
<span style="color: #ff0099">   26: </span>
<span style="color: #ff0099">   27: </span>  <span style="color: #990000">template</span><span style="color: #330033">&lt;</span><span style="color: #990000">typename</span> <span style="color: #000000">NT</span><span style="color: #330033">,</span> <span style="color: #990000">typename</span> <span style="color: #000000">AT</span><span style="color: #330033">&gt;</span> <span style="color: #990000">class</span> <span style="color: #000000">digraph_node</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   28: </span>  <span style="color: #990000">template</span><span style="color: #330033">&lt;</span><span style="color: #990000">typename</span> <span style="color: #000000">NT</span><span style="color: #330033">,</span> <span style="color: #990000">typename</span> <span style="color: #000000">AT</span><span style="color: #330033">&gt;</span> <span style="color: #990000">class</span> <span style="color: #000000">digraph_arc</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   29: </span>  <span style="color: #990000">template</span><span style="color: #330033">&lt;</span><span style="color: #990000">typename</span> <span style="color: #000000">NT</span><span style="color: #330033">,</span> <span style="color: #990000">typename</span> <span style="color: #000000">AT</span><span style="color: #330033">&gt;</span> <span style="color: #990000">class</span> <span style="color: #000000">digraph</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   30: </span>
<span style="color: #ff0099">   31: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">   32: </span>  <span style="color: #000099">// The Digraph iterator classes</span>
<span style="color: #ff0099">   33: </span>  <span style="color: #000099">// a digraph_iterator points to a node whilst a digraph_arc_iterator points to an arc</span>
<span style="color: #ff0099">   34: </span>  <span style="color: #000099">// Note that these are redefined as:</span>
<span style="color: #ff0099">   35: </span>  <span style="color: #000099">//   digraph&lt;NT,AT&gt;::iterator           - points to a non-const node</span>
<span style="color: #ff0099">   36: </span>  <span style="color: #000099">//   digraph&lt;NT,AT&gt;::const_iterator     - points to a const node</span>
<span style="color: #ff0099">   37: </span>  <span style="color: #000099">//   digraph&lt;NT,AT&gt;::arc_iterator       - points to a non-const arc</span>
<span style="color: #ff0099">   38: </span>  <span style="color: #000099">//   digraph&lt;NT,AT&gt;::const_arc_iterator - points to a const arc</span>
<span style="color: #ff0099">   39: </span>  <span style="color: #000099">// and this is the form in which they should be used</span>
<span style="color: #ff0099">   40: </span>
<span style="color: #ff0099">   41: </span>  <span style="color: #990000">template</span><span style="color: #330033">&lt;</span><span style="color: #990000">typename</span> <span style="color: #000000">NT</span><span style="color: #330033">,</span> <span style="color: #990000">typename</span> <span style="color: #000000">AT</span><span style="color: #330033">,</span> <span style="color: #990000">typename</span> <span style="color: #000000">NRef</span><span style="color: #330033">,</span> <span style="color: #990000">typename</span> <span style="color: #000000">NPtr</span><span style="color: #330033">&gt;</span>
<span style="color: #ff0099">   42: </span>  <span style="color: #990000">class</span> <span style="color: #000000">digraph_iterator</span> <span style="color: #330033">:</span> <span style="color: #990000">public</span> <span style="color: #000000">safe_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">,</span> <span style="color: #000000">digraph_node</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span> <span style="color: #330033">&gt;</span>
<span style="color: #ff0099">   43: </span>  <span style="color: #330033">{</span>
<span style="color: #ff0099">   44: </span>  <span style="color: #990000">public</span><span style="color: #330033">:</span>
<span style="color: #ff0099">   45: </span>    <span style="color: #990000">friend</span> <span style="color: #990000">class</span> <span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   46: </span>
<span style="color: #ff0099">   47: </span>    <span style="color: #000099">// local type definitions</span>
<span style="color: #ff0099">   48: </span>    <span style="color: #000099">// an iterator points to an object whilst a const_iterator points to a const object</span>
<span style="color: #ff0099">   49: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">digraph_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #000000">NT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #000000">NT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span> <span style="color: #000000">iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   50: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">digraph_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #990000">const</span> <span style="color: #000000">NT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #990000">const</span> <span style="color: #000000">NT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span> <span style="color: #000000">const_iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   51: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">digraph_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #000000">NRef</span><span style="color: #330033">,</span><span style="color: #000000">NPtr</span><span style="color: #330033">&gt;</span> <span style="color: #000000">this_iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   52: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">NRef</span> <span style="color: #000000">reference</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   53: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">NPtr</span> <span style="color: #000000">pointer</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   54: </span>
<span style="color: #ff0099">   55: </span>    <span style="color: #000099">// constructor to create a null iterator - you must assign a valid value to this iterator before using it</span>
<span style="color: #ff0099">   56: </span>    <span style="color: #000000">digraph_iterator</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   57: </span>    <span style="color: #330033">~</span><span style="color: #000000">digraph_iterator</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   58: </span>
<span style="color: #ff0099">   59: </span>    <span style="color: #000099">// Type conversion methods allow const_iterator and iterator to be converted</span>
<span style="color: #ff0099">   60: </span>    <span style="color: #000099">// convert an iterator/const_iterator to a const_iterator</span>
<span style="color: #ff0099">   61: </span>    <span style="color: #000000">const_iterator</span> <span style="color: #000000">constify</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   62: </span>    <span style="color: #000099">// convert an iterator/const_iterator to an iterator</span>
<span style="color: #ff0099">   63: </span>    <span style="color: #000000">iterator</span> <span style="color: #000000">deconstify</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   64: </span>
<span style="color: #ff0099">   65: </span>    <span style="color: #000099">// increment/decrement operators used to step through the set of all nodes in a graph</span>
<span style="color: #ff0099">   66: </span>    <span style="color: #000099">// it is only legal to increment a valid iterator</span>
<span style="color: #ff0099">   67: </span>    <span style="color: #000099">// pre-increment</span>
<span style="color: #ff0099">   68: </span>    <span style="color: #000000">this_iterator</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">+</span><span style="color: #330033">+</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span>
<span style="color: #ff0099">   69: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   70: </span>    <span style="color: #000099">// post-increment</span>
<span style="color: #ff0099">   71: </span>    <span style="color: #000000">this_iterator</span> <span style="color: #990000">operator</span> <span style="color: #330033">+</span><span style="color: #330033">+</span> <span style="color: #330033">(</span><span style="color: #990000">int</span><span style="color: #330033">)</span>
<span style="color: #ff0099">   72: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   73: </span>    <span style="color: #000099">// pre-decrement</span>
<span style="color: #ff0099">   74: </span>    <span style="color: #000000">this_iterator</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">-</span><span style="color: #330033">-</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span>
<span style="color: #ff0099">   75: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   76: </span>    <span style="color: #000099">// post-decrement</span>
<span style="color: #ff0099">   77: </span>    <span style="color: #000000">this_iterator</span> <span style="color: #990000">operator</span> <span style="color: #330033">-</span><span style="color: #330033">-</span> <span style="color: #330033">(</span><span style="color: #990000">int</span><span style="color: #330033">)</span>
<span style="color: #ff0099">   78: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   79: </span>
<span style="color: #ff0099">   80: </span>    <span style="color: #000099">// test useful for testing whether iteration has completed and for inclusion in other containers</span>
<span style="color: #ff0099">   81: </span>    <span style="color: #000099">// Note: this class also inherits the safe_iterator methods: valid(), null(), end()</span>
<span style="color: #ff0099">   82: </span>    <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">this_iterator</span><span style="color: #330033">&amp;</span> <span style="color: #000000">r</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   83: </span>    <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">!</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">this_iterator</span><span style="color: #330033">&amp;</span> <span style="color: #000000">r</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   84: </span>    <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">&lt;</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">this_iterator</span><span style="color: #330033">&amp;</span> <span style="color: #000000">r</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   85: </span>
<span style="color: #ff0099">   86: </span>    <span style="color: #000099">// access the node data - a const_iterator gives you a const element, an iterator a non-const element</span>
<span style="color: #ff0099">   87: </span>    <span style="color: #000099">// it is illegal to dereference an invalid (i.e. null or end) iterator</span>
<span style="color: #ff0099">   88: </span>    <span style="color: #000000">reference</span> <span style="color: #990000">operator</span><span style="color: #330033">*</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">   89: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   90: </span>    <span style="color: #000000">pointer</span> <span style="color: #990000">operator</span><span style="color: #330033">-&gt;</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">   91: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   92: </span>
<span style="color: #ff0099">   93: </span>  <span style="color: #990000">public</span><span style="color: #330033">:</span>
<span style="color: #ff0099">   94: </span>    <span style="color: #000099">// constructor used by digraph to create a non-null iterator</span>
<span style="color: #ff0099">   95: </span>    <span style="color: #990000">explicit</span> <span style="color: #000000">digraph_iterator</span><span style="color: #330033">(</span><span style="color: #000000">digraph_node</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">*</span> <span style="color: #000000">node</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   96: </span>    <span style="color: #000099">// constructor used by digraph to create an end iterator</span>
<span style="color: #ff0099">   97: </span>    <span style="color: #990000">explicit</span> <span style="color: #000000">digraph_iterator</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">*</span> <span style="color: #000000">owner</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">   98: </span>    <span style="color: #000099">// used to create an alias of an iterator</span>
<span style="color: #ff0099">   99: </span>    <span style="color: #990000">explicit</span> <span style="color: #000000">digraph_iterator</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">safe_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">,</span> <span style="color: #000000">digraph_node</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span> <span style="color: #330033">&gt;</span><span style="color: #330033">&amp;</span> <span style="color: #000000">iterator</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  100: </span>  <span style="color: #330033">}</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  101: </span>
<span style="color: #ff0099">  102: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  103: </span>
<span style="color: #ff0099">  104: </span>  <span style="color: #990000">template</span><span style="color: #330033">&lt;</span><span style="color: #990000">typename</span> <span style="color: #000000">NT</span><span style="color: #330033">,</span> <span style="color: #990000">typename</span> <span style="color: #000000">AT</span><span style="color: #330033">,</span> <span style="color: #990000">typename</span> <span style="color: #000000">ARef</span><span style="color: #330033">,</span> <span style="color: #990000">typename</span> <span style="color: #000000">APtr</span><span style="color: #330033">&gt;</span>
<span style="color: #ff0099">  105: </span>  <span style="color: #990000">class</span> <span style="color: #000000">digraph_arc_iterator</span> <span style="color: #330033">:</span> <span style="color: #990000">public</span> <span style="color: #000000">safe_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">,</span> <span style="color: #000000">digraph_arc</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span> <span style="color: #330033">&gt;</span>
<span style="color: #ff0099">  106: </span>  <span style="color: #330033">{</span>
<span style="color: #ff0099">  107: </span>  <span style="color: #990000">public</span><span style="color: #330033">:</span>
<span style="color: #ff0099">  108: </span>    <span style="color: #990000">friend</span> <span style="color: #990000">class</span> <span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  109: </span>
<span style="color: #ff0099">  110: </span>    <span style="color: #000099">// local type definitions</span>
<span style="color: #ff0099">  111: </span>    <span style="color: #000099">// an iterator points to an object whilst a const_iterator points to a const object</span>
<span style="color: #ff0099">  112: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span> <span style="color: #000000">iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  113: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #990000">const</span> <span style="color: #000000">AT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #990000">const</span> <span style="color: #000000">AT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span> <span style="color: #000000">const_iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  114: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #000000">ARef</span><span style="color: #330033">,</span><span style="color: #000000">APtr</span><span style="color: #330033">&gt;</span> <span style="color: #000000">this_iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  115: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">ARef</span> <span style="color: #000000">reference</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  116: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">APtr</span> <span style="color: #000000">pointer</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  117: </span>
<span style="color: #ff0099">  118: </span>    <span style="color: #000099">// constructor to create a null iterator - you must assign a valid value to this iterator before using it</span>
<span style="color: #ff0099">  119: </span>    <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  120: </span>    <span style="color: #330033">~</span><span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  121: </span>
<span style="color: #ff0099">  122: </span>    <span style="color: #000099">// Type conversion methods allow const_iterator and iterator to be converted</span>
<span style="color: #ff0099">  123: </span>    <span style="color: #000099">// convert an iterator/const_iterator to a const_iterator</span>
<span style="color: #ff0099">  124: </span>    <span style="color: #000000">const_iterator</span> <span style="color: #000000">constify</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  125: </span>    <span style="color: #000099">// convert an iterator/const_iterator to an iterator</span>
<span style="color: #ff0099">  126: </span>    <span style="color: #000000">iterator</span> <span style="color: #000000">deconstify</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  127: </span>
<span style="color: #ff0099">  128: </span>    <span style="color: #000099">// increment/decrement operators used to step through the set of all nodes in a graph</span>
<span style="color: #ff0099">  129: </span>    <span style="color: #000099">// it is only legal to increment a valid iterator</span>
<span style="color: #ff0099">  130: </span>    <span style="color: #000099">// pre-increment</span>
<span style="color: #ff0099">  131: </span>    <span style="color: #000000">this_iterator</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">+</span><span style="color: #330033">+</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  132: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  133: </span>    <span style="color: #000099">// post-increment</span>
<span style="color: #ff0099">  134: </span>    <span style="color: #000000">this_iterator</span> <span style="color: #990000">operator</span> <span style="color: #330033">+</span><span style="color: #330033">+</span> <span style="color: #330033">(</span><span style="color: #990000">int</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  135: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  136: </span>    <span style="color: #000099">// pre-decrement</span>
<span style="color: #ff0099">  137: </span>    <span style="color: #000000">this_iterator</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">-</span><span style="color: #330033">-</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  138: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  139: </span>    <span style="color: #000099">// post-decrement</span>
<span style="color: #ff0099">  140: </span>    <span style="color: #000000">this_iterator</span> <span style="color: #990000">operator</span> <span style="color: #330033">-</span><span style="color: #330033">-</span> <span style="color: #330033">(</span><span style="color: #990000">int</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  141: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  142: </span>
<span style="color: #ff0099">  143: </span>    <span style="color: #000099">// test useful for testing whether iteration has completed and for inclusion in other containers</span>
<span style="color: #ff0099">  144: </span>    <span style="color: #000099">// Note: this class also inherits the safe_iterator methods: valid(), null(), end()</span>
<span style="color: #ff0099">  145: </span>    <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">this_iterator</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  146: </span>    <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">!</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">this_iterator</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  147: </span>    <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">&lt;</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">this_iterator</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  148: </span>
<span style="color: #ff0099">  149: </span>    <span style="color: #000099">// access the node data - a const_iterator gives you a const element, an iterator a non-const element</span>
<span style="color: #ff0099">  150: </span>    <span style="color: #000099">// it is illegal to dereference an invalid (i.e. null or end) iterator</span>
<span style="color: #ff0099">  151: </span>    <span style="color: #000000">reference</span> <span style="color: #990000">operator</span><span style="color: #330033">*</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  152: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  153: </span>    <span style="color: #000000">pointer</span> <span style="color: #990000">operator</span><span style="color: #330033">-&gt;</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  154: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  155: </span>
<span style="color: #ff0099">  156: </span>  <span style="color: #990000">public</span><span style="color: #330033">:</span>
<span style="color: #ff0099">  157: </span>    <span style="color: #000099">// constructor used by digraph to create a non-null iterator</span>
<span style="color: #ff0099">  158: </span>    <span style="color: #990000">explicit</span> <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">(</span><span style="color: #000000">digraph_arc</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">*</span> <span style="color: #000000">arc</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  159: </span>    <span style="color: #000099">// constructor used by digraph to create an end iterator</span>
<span style="color: #ff0099">  160: </span>    <span style="color: #990000">explicit</span> <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">*</span> <span style="color: #000000">owner</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  161: </span>    <span style="color: #000099">// used to create an alias of an iterator</span>
<span style="color: #ff0099">  162: </span>    <span style="color: #990000">explicit</span> <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">safe_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">,</span> <span style="color: #000000">digraph_arc</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span> <span style="color: #330033">&gt;</span><span style="color: #330033">&amp;</span> <span style="color: #000000">iterator</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  163: </span>  <span style="color: #330033">}</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  164: </span>
<span style="color: #ff0099">  165: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  166: </span>  <span style="color: #000099">// The Graph class</span>
<span style="color: #ff0099">  167: </span>  <span style="color: #000099">// NT is the Node type and AT is the Arc type</span>
<span style="color: #ff0099">  168: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  169: </span>
<span style="color: #ff0099">  170: </span>  <span style="color: #990000">template</span><span style="color: #330033">&lt;</span><span style="color: #990000">typename</span> <span style="color: #000000">NT</span><span style="color: #330033">,</span> <span style="color: #990000">typename</span> <span style="color: #000000">AT</span><span style="color: #330033">&gt;</span>
<span style="color: #ff0099">  171: </span>  <span style="color: #990000">class</span> <span style="color: #000000">digraph</span>
<span style="color: #ff0099">  172: </span>  <span style="color: #330033">{</span>
<span style="color: #ff0099">  173: </span>  <span style="color: #990000">public</span><span style="color: #330033">:</span>
<span style="color: #ff0099">  174: </span>    <span style="color: #000099">// STL-like typedefs for the types and iterators</span>
<span style="color: #ff0099">  175: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">NT</span> <span style="color: #000000">node_type</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  176: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">AT</span> <span style="color: #000000">arc_type</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  177: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">digraph_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #000000">NT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #000000">NT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span> <span style="color: #000000">iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  178: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">digraph_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #990000">const</span> <span style="color: #000000">NT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #990000">const</span> <span style="color: #000000">NT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span> <span style="color: #000000">const_iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  179: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span> <span style="color: #000000">arc_iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  180: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #990000">const</span> <span style="color: #000000">AT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">AT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span> <span style="color: #000000">const_arc_iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  181: </span>
<span style="color: #ff0099">  182: </span>    <span style="color: #000099">// supplementary types used throughout</span>
<span style="color: #ff0099">  183: </span>
<span style="color: #ff0099">  184: </span>    <span style="color: #000099">// a path is represented as a vector of arcs so the forward traversal is</span>
<span style="color: #ff0099">  185: </span>    <span style="color: #000099">// done by going from begin() to end() or 0 to size-1 - of course a backward</span>
<span style="color: #ff0099">  186: </span>    <span style="color: #000099">// traversal can be done by traversing the vector backwards</span>
<span style="color: #ff0099">  187: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">arc_iterator</span><span style="color: #330033">&gt;</span> <span style="color: #000000">arc_vector</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  188: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">const_arc_iterator</span><span style="color: #330033">&gt;</span> <span style="color: #000000">const_arc_vector</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  189: </span>    <span style="color: #000000">const_arc_vector</span> <span style="color: #000000">constify_arcs</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">arc_vector</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  190: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  191: </span>    <span style="color: #000000">arc_vector</span> <span style="color: #000000">deconstify_arcs</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">const_arc_vector</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  192: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  193: </span>
<span style="color: #ff0099">  194: </span>    <span style="color: #000099">// a path vector is a vector of paths used to represent all the paths from one node to another</span>
<span style="color: #ff0099">  195: </span>    <span style="color: #000099">// there is no particular ordering to the paths in the vector</span>
<span style="color: #ff0099">  196: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">arc_vector</span><span style="color: #330033">&gt;</span> <span style="color: #000000">path_vector</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  197: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">const_arc_vector</span><span style="color: #330033">&gt;</span> <span style="color: #000000">const_path_vector</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  198: </span>    <span style="color: #000000">const_path_vector</span> <span style="color: #000000">constify_paths</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">path_vector</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  199: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  200: </span>    <span style="color: #000000">path_vector</span> <span style="color: #000000">deconstify_paths</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">const_path_vector</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  201: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  202: </span>
<span style="color: #ff0099">  203: </span>    <span style="color: #000099">// a node vector is a simple vector of nodes used to represent the reachable sets</span>
<span style="color: #ff0099">  204: </span>    <span style="color: #000099">// there is no particular ordering to the nodes in the vector</span>
<span style="color: #ff0099">  205: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">iterator</span><span style="color: #330033">&gt;</span> <span style="color: #000000">node_vector</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  206: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">const_iterator</span><span style="color: #330033">&gt;</span> <span style="color: #000000">const_node_vector</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  207: </span>    <span style="color: #000000">const_node_vector</span> <span style="color: #000000">constify_nodes</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">node_vector</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  208: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  209: </span>    <span style="color: #000000">node_vector</span> <span style="color: #000000">deconstify_nodes</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">const_node_vector</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  210: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  211: </span>
<span style="color: #ff0099">  212: </span>    <span style="color: #000099">// callback used in the path algorithms to select which arcs to consider</span>
<span style="color: #ff0099">  213: </span>    <span style="color: #990000">typedef</span> <span style="color: #990000">bool</span> <span style="color: #330033">(</span><span style="color: #330033">*</span><span style="color: #000000">arc_select_fn</span><span style="color: #330033">)</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #000000">const_arc_iterator</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  214: </span>
<span style="color: #ff0099">  215: </span>    <span style="color: #000099">// a value representing an unknown offset</span>
<span style="color: #ff0099">  216: </span>    <span style="color: #000099">// Note that it's static so use in the form digraph&lt;NT,AT&gt;::npos()</span>
<span style="color: #ff0099">  217: </span>    <span style="color: #990000">static</span> <span style="color: #990000">unsigned</span> <span style="color: #000000">npos</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  218: </span>
<span style="color: #ff0099">  219: </span>    <span style="color: #000099">//////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  220: </span>    <span style="color: #000099">// Constructors, destructors and copies</span>
<span style="color: #ff0099">  221: </span>
<span style="color: #ff0099">  222: </span>    <span style="color: #000000">digraph</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  223: </span>    <span style="color: #330033">~</span><span style="color: #000000">digraph</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  224: </span>
<span style="color: #ff0099">  225: </span>    <span style="color: #000099">// copy constructor and assignment both copy the graph</span>
<span style="color: #ff0099">  226: </span>    <span style="color: #000000">digraph</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  227: </span>    <span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span><span style="color: #330033">=</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">digraph</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  228: </span>
<span style="color: #ff0099">  229: </span>    <span style="color: #000099">//////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  230: </span>    <span style="color: #000099">// Basic Node functions</span>
<span style="color: #ff0099">  231: </span>    <span style="color: #000099">// Nodes are referred to by iterators created when the node is inserted.</span>
<span style="color: #ff0099">  232: </span>    <span style="color: #000099">// Iterators remain valid unless the node is erased (they are list iterators, so no resize problems)</span>
<span style="color: #ff0099">  233: </span>    <span style="color: #000099">// It is also possible to walk through all the nodes using a list-like start() to end() loop</span>
<span style="color: #ff0099">  234: </span>    <span style="color: #000099">// Each node has a set of input arcs and output arcs. These are indexed by an unsigned i.e. they form a vector.</span>
<span style="color: #ff0099">  235: </span>    <span style="color: #000099">// The total number of inputs is the fanin and the total number of outputs is the fanout.</span>
<span style="color: #ff0099">  236: </span>    <span style="color: #000099">// The contents of the node (type NT) are accessed, of course, by dereferencing the node iterator.</span>
<span style="color: #ff0099">  237: </span>
<span style="color: #ff0099">  238: </span>    <span style="color: #000099">// tests for the number of nodes and the special test for zero nodes</span>
<span style="color: #ff0099">  239: </span>    <span style="color: #990000">bool</span> <span style="color: #000000">empty</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  240: </span>    <span style="color: #990000">unsigned</span> <span style="color: #000000">size</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  241: </span>
<span style="color: #ff0099">  242: </span>    <span style="color: #000099">// add a new node and return its iterator</span>
<span style="color: #ff0099">  243: </span>    <span style="color: #000000">iterator</span> <span style="color: #000000">insert</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">NT</span><span style="color: #330033">&amp;</span> <span style="color: #000000">node_data</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  244: </span>
<span style="color: #ff0099">  245: </span>    <span style="color: #000099">// remove a node and return the iterator to the next node</span>
<span style="color: #ff0099">  246: </span>    <span style="color: #000099">// erasing a node erases its arcs</span>
<span style="color: #ff0099">  247: </span>    <span style="color: #000000">iterator</span> <span style="color: #000000">erase</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  248: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  249: </span>    <span style="color: #000099">// remove all nodes</span>
<span style="color: #ff0099">  250: </span>    <span style="color: #990000">void</span> <span style="color: #000000">clear</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  251: </span>
<span style="color: #ff0099">  252: </span>    <span style="color: #000099">// traverse all the nodes in no particular order using STL-style iteration</span>
<span style="color: #ff0099">  253: </span>    <span style="color: #000000">const_iterator</span> <span style="color: #000000">begin</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  254: </span>    <span style="color: #000000">iterator</span> <span style="color: #000000">begin</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  255: </span>    <span style="color: #000000">const_iterator</span> <span style="color: #000000">end</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  256: </span>    <span style="color: #000000">iterator</span> <span style="color: #000000">end</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  257: </span>
<span style="color: #ff0099">  258: </span>    <span style="color: #000099">// access the inputs of this node</span>
<span style="color: #ff0099">  259: </span>    <span style="color: #000099">// the fanin is the number of inputs and the inputs are accessed using an index from 0..fanin-1</span>
<span style="color: #ff0099">  260: </span>    <span style="color: #990000">unsigned</span> <span style="color: #000000">fanin</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  261: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  262: </span>    <span style="color: #990000">unsigned</span> <span style="color: #000000">fanin</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  263: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  264: </span>    <span style="color: #000000">const_arc_iterator</span> <span style="color: #000000">input</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  265: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">,</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">out_of_range</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  266: </span>    <span style="color: #000000">arc_iterator</span> <span style="color: #000000">input</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  267: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">,</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">out_of_range</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  268: </span>
<span style="color: #ff0099">  269: </span>    <span style="color: #000099">// access the outputs of this node</span>
<span style="color: #ff0099">  270: </span>    <span style="color: #000099">// the fanout is the number of outputs and the outputs are accessed using an index from 0..fanout-1</span>
<span style="color: #ff0099">  271: </span>    <span style="color: #990000">unsigned</span> <span style="color: #000000">fanout</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  272: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  273: </span>    <span style="color: #990000">unsigned</span> <span style="color: #000000">fanout</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  274: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  275: </span>    <span style="color: #000000">const_arc_iterator</span> <span style="color: #000000">output</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  276: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">,</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">out_of_range</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  277: </span>    <span style="color: #000000">arc_iterator</span> <span style="color: #000000">output</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  278: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">,</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">out_of_range</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  279: </span>
<span style="color: #ff0099">  280: </span>    <span style="color: #000099">// convenience routines for getting the set of all inputs or all outputs as vectors</span>
<span style="color: #ff0099">  281: </span>    <span style="color: #000000">const_arc_vector</span> <span style="color: #000000">inputs</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  282: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  283: </span>    <span style="color: #000000">arc_vector</span> <span style="color: #000000">inputs</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  284: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  285: </span>    <span style="color: #000000">const_arc_vector</span> <span style="color: #000000">outputs</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  286: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  287: </span>    <span style="color: #000000">arc_vector</span> <span style="color: #000000">outputs</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  288: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  289: </span>
<span style="color: #ff0099">  290: </span>    <span style="color: #000099">// find the output index of an arc which goes from this node</span>
<span style="color: #ff0099">  291: </span>    <span style="color: #000099">// returns digraph&lt;NT,AT&gt;::npos if the arc is not an output of from</span>
<span style="color: #ff0099">  292: </span>    <span style="color: #990000">unsigned</span> <span style="color: #000000">output_offset</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">const_arc_iterator</span> <span style="color: #000000">arc</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  293: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  294: </span>    <span style="color: #990000">unsigned</span> <span style="color: #000000">output_offset</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">arc_iterator</span> <span style="color: #000000">arc</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  295: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  296: </span>    <span style="color: #000099">// ditto for an input arc</span>
<span style="color: #ff0099">  297: </span>    <span style="color: #990000">unsigned</span> <span style="color: #000000">input_offset</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">const_arc_iterator</span> <span style="color: #000000">arc</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  298: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  299: </span>    <span style="color: #990000">unsigned</span> <span style="color: #000000">input_offset</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">arc_iterator</span> <span style="color: #000000">arc</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  300: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  301: </span>
<span style="color: #ff0099">  302: </span>    <span style="color: #000099">//////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  303: </span>    <span style="color: #000099">// Basic Arc functions</span>
<span style="color: #ff0099">  304: </span>    <span style="color: #000099">// to avoid name conflicts, arc functions have the arc_ prefix </span>
<span style="color: #ff0099">  305: </span>    <span style="color: #000099">// Arcs, like nodes, are referred to by a list iterator which is returned by the arc_insert function</span>
<span style="color: #ff0099">  306: </span>    <span style="color: #000099">// They may also be visited from arc_begin() to arc_end()</span>
<span style="color: #ff0099">  307: </span>    <span style="color: #000099">// Each arc has a from field and a to field which contain the node iterators of the endpoints of the arc</span>
<span style="color: #ff0099">  308: </span>    <span style="color: #000099">// Of course, the arc data can be accessed by simply dereferencing the iterator</span>
<span style="color: #ff0099">  309: </span>
<span style="color: #ff0099">  310: </span>    <span style="color: #000099">// tests for the number of arcs and the special test for zero arcs</span>
<span style="color: #ff0099">  311: </span>    <span style="color: #990000">bool</span> <span style="color: #000000">arc_empty</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  312: </span>    <span style="color: #990000">unsigned</span> <span style="color: #000000">arc_size</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  313: </span>
<span style="color: #ff0099">  314: </span>    <span style="color: #000099">// add a new arc and return its iterator</span>
<span style="color: #ff0099">  315: </span>    <span style="color: #000000">arc_iterator</span> <span style="color: #000000">arc_insert</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">AT</span><span style="color: #330033">&amp;</span> <span style="color: #000000">arc_data</span> <span style="color: #330033">=</span> <span style="color: #000000">AT</span><span style="color: #330033">(</span><span style="color: #330033">)</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  316: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  317: </span>
<span style="color: #ff0099">  318: </span>    <span style="color: #000099">// remove an arc and return the iterator to the next arc</span>
<span style="color: #ff0099">  319: </span>    <span style="color: #000000">arc_iterator</span> <span style="color: #000000">arc_erase</span><span style="color: #330033">(</span><span style="color: #000000">arc_iterator</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  320: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  321: </span>    <span style="color: #000099">// remove all arcs</span>
<span style="color: #ff0099">  322: </span>    <span style="color: #990000">void</span> <span style="color: #000000">arc_clear</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  323: </span>
<span style="color: #ff0099">  324: </span>    <span style="color: #000099">// traverse all the arcs in no particular order using STL-style iteration</span>
<span style="color: #ff0099">  325: </span>    <span style="color: #000000">const_arc_iterator</span> <span style="color: #000000">arc_begin</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  326: </span>    <span style="color: #000000">arc_iterator</span> <span style="color: #000000">arc_begin</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  327: </span>    <span style="color: #000000">const_arc_iterator</span> <span style="color: #000000">arc_end</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  328: </span>    <span style="color: #000000">arc_iterator</span> <span style="color: #000000">arc_end</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  329: </span>
<span style="color: #ff0099">  330: </span>    <span style="color: #000099">// find the node that an arc points from or to</span>
<span style="color: #ff0099">  331: </span>    <span style="color: #000000">const_iterator</span> <span style="color: #000000">arc_from</span><span style="color: #330033">(</span><span style="color: #000000">const_arc_iterator</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  332: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  333: </span>    <span style="color: #000000">iterator</span> <span style="color: #000000">arc_from</span><span style="color: #330033">(</span><span style="color: #000000">arc_iterator</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  334: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  335: </span>    <span style="color: #000000">const_iterator</span> <span style="color: #000000">arc_to</span><span style="color: #330033">(</span><span style="color: #000000">const_arc_iterator</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  336: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  337: </span>    <span style="color: #000000">iterator</span> <span style="color: #000000">arc_to</span><span style="color: #330033">(</span><span style="color: #000000">arc_iterator</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  338: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  339: </span>
<span style="color: #ff0099">  340: </span>    <span style="color: #000099">// reconnect an arc to a different from and to node</span>
<span style="color: #ff0099">  341: </span>    <span style="color: #990000">void</span> <span style="color: #000000">arc_move</span><span style="color: #330033">(</span><span style="color: #000000">arc_iterator</span> <span style="color: #000000">arc</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  342: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  343: </span>    <span style="color: #000099">// reconnect just the from node</span>
<span style="color: #ff0099">  344: </span>    <span style="color: #990000">void</span> <span style="color: #000000">arc_move_from</span><span style="color: #330033">(</span><span style="color: #000000">arc_iterator</span> <span style="color: #000000">arc</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  345: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  346: </span>    <span style="color: #000099">// reconnect just the to node</span>
<span style="color: #ff0099">  347: </span>    <span style="color: #990000">void</span> <span style="color: #000000">arc_move_to</span><span style="color: #330033">(</span><span style="color: #000000">arc_iterator</span> <span style="color: #000000">arc</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  348: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  349: </span>    <span style="color: #000099">// reverse the arc direction so that to becomes from and vice-versa</span>
<span style="color: #ff0099">  350: </span>    <span style="color: #990000">void</span> <span style="color: #000000">arc_flip</span><span style="color: #330033">(</span><span style="color: #000000">arc_iterator</span> <span style="color: #000000">arc</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  351: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  352: </span>
<span style="color: #ff0099">  353: </span>    <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  354: </span>    <span style="color: #000099">// Adjacency algorithms</span>
<span style="color: #ff0099">  355: </span>
<span style="color: #ff0099">  356: </span>    <span style="color: #000099">// test whether the nodes are adjacent i.e. whether there is an arc going from from to to</span>
<span style="color: #ff0099">  357: </span>    <span style="color: #990000">bool</span> <span style="color: #000000">adjacent</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  358: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  359: </span>    <span style="color: #990000">bool</span> <span style="color: #000000">adjacent</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  360: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  361: </span>
<span style="color: #ff0099">  362: </span>    <span style="color: #000099">// as above, but returns the arc that makes the nodes adjacent</span>
<span style="color: #ff0099">  363: </span>    <span style="color: #000099">// returns the first arc if there's more than one, returns arc_end() if there are none</span>
<span style="color: #ff0099">  364: </span>    <span style="color: #000000">const_arc_iterator</span> <span style="color: #000000">adjacent_arc</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  365: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  366: </span>    <span style="color: #000000">arc_iterator</span> <span style="color: #000000">adjacent_arc</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  367: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  368: </span>
<span style="color: #ff0099">  369: </span>    <span style="color: #000099">// as above, but returns the set of all arcs that make two nodes adjacent (there may be more than one)</span>
<span style="color: #ff0099">  370: </span>    <span style="color: #000099">// returns an empty vector if there are none</span>
<span style="color: #ff0099">  371: </span>    <span style="color: #000000">const_arc_vector</span> <span style="color: #000000">adjacent_arcs</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  372: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  373: </span>    <span style="color: #000000">arc_vector</span> <span style="color: #000000">adjacent_arcs</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  374: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  375: </span>
<span style="color: #ff0099">  376: </span>    <span style="color: #000099">// return the adjacency sets for the node inputs or outputs, i.e. the set of nodes adjacent to this node</span>
<span style="color: #ff0099">  377: </span>    <span style="color: #000099">// each adjacent node will only be entered once even if there are multiple arcs between the nodes</span>
<span style="color: #ff0099">  378: </span>    <span style="color: #000000">const_node_vector</span> <span style="color: #000000">input_adjacencies</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  379: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  380: </span>    <span style="color: #000000">node_vector</span> <span style="color: #000000">input_adjacencies</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  381: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  382: </span>    <span style="color: #000000">const_node_vector</span> <span style="color: #000000">output_adjacencies</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  383: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  384: </span>    <span style="color: #000000">node_vector</span> <span style="color: #000000">output_adjacencies</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  385: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  386: </span>
<span style="color: #ff0099">  387: </span>    <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  388: </span>    <span style="color: #000099">// Topographical Sort Algorithm</span>
<span style="color: #ff0099">  389: </span>    <span style="color: #000099">// This generates a node ordering such that each node is visited after its fanin nodes.</span>
<span style="color: #ff0099">  390: </span>
<span style="color: #ff0099">  391: </span>    <span style="color: #000099">// This only generates a valid ordering for a DAG. </span>
<span style="color: #ff0099">  392: </span>
<span style="color: #ff0099">  393: </span>    <span style="color: #000099">// The return value is a pair : </span>
<span style="color: #ff0099">  394: </span>    <span style="color: #000099">//  - the node vector which is a set of iterators to the nodes in sorted order</span>
<span style="color: #ff0099">  395: </span>    <span style="color: #000099">//  - the arc vector is the set of backward ards that were broken to achieve the sort</span>
<span style="color: #ff0099">  396: </span>    <span style="color: #000099">// If the arc vector is empty then the graph formed a DAG.</span>
<span style="color: #ff0099">  397: </span>
<span style="color: #ff0099">  398: </span>    <span style="color: #000099">// The arc selection callback can be used to ignore arcs that are not part</span>
<span style="color: #ff0099">  399: </span>    <span style="color: #000099">// of the ordering, i.e. arcs that are meant to be backwards arcs</span>
<span style="color: #ff0099">  400: </span>
<span style="color: #ff0099">  401: </span>    <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">pair</span><span style="color: #330033">&lt;</span><span style="color: #000000">const_node_vector</span><span style="color: #330033">,</span><span style="color: #000000">const_arc_vector</span><span style="color: #330033">&gt;</span> <span style="color: #000000">sort</span><span style="color: #330033">(</span><span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  402: </span>    <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">pair</span><span style="color: #330033">&lt;</span><span style="color: #000000">node_vector</span><span style="color: #330033">,</span><span style="color: #000000">arc_vector</span><span style="color: #330033">&gt;</span> <span style="color: #000000">sort</span><span style="color: #330033">(</span><span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  403: </span>
<span style="color: #ff0099">  404: </span>    <span style="color: #000099">// Simplified variant of above for graphs that are known to be DAGs.</span>
<span style="color: #ff0099">  405: </span>    <span style="color: #000099">// If the sort fails due to backward arcs, the</span>
<span style="color: #ff0099">  406: </span>    <span style="color: #000099">// return vector is empty. Note that this will also be empty if the graph</span>
<span style="color: #ff0099">  407: </span>    <span style="color: #000099">// has no nodes in it, so use the empty() method to differentiate.</span>
<span style="color: #ff0099">  408: </span>
<span style="color: #ff0099">  409: </span>    <span style="color: #000000">const_node_vector</span> <span style="color: #000000">dag_sort</span><span style="color: #330033">(</span><span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  410: </span>    <span style="color: #000000">node_vector</span> <span style="color: #000000">dag_sort</span><span style="color: #330033">(</span><span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  411: </span>
<span style="color: #ff0099">  412: </span>    <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  413: </span>    <span style="color: #000099">// Basic Path Algorithms</span>
<span style="color: #ff0099">  414: </span>    <span style="color: #000099">// A path is a series of arcs - you can use arc_from and arc_to to convert</span>
<span style="color: #ff0099">  415: </span>    <span style="color: #000099">// that into a series of nodes. All the path algorithms take an arc_select</span>
<span style="color: #ff0099">  416: </span>    <span style="color: #000099">// which allows arcs to be selected or rejected for consideration in a path.</span>
<span style="color: #ff0099">  417: </span>
<span style="color: #ff0099">  418: </span>    <span style="color: #000099">// A selection callback function is applied to each arc in the traversal and</span>
<span style="color: #ff0099">  419: </span>    <span style="color: #000099">// returns true if the arc is to be selected and false if the arc is to be</span>
<span style="color: #ff0099">  420: </span>    <span style="color: #000099">// rejected. If no function is provided the arc is selected. If you want to</span>
<span style="color: #ff0099">  421: </span>    <span style="color: #000099">// use arc selection you should create a function with the type profile given</span>
<span style="color: #ff0099">  422: </span>    <span style="color: #000099">// by the arc_select_fn type. The select function is passed both the graph and</span>
<span style="color: #ff0099">  423: </span>    <span style="color: #000099">// the arc iterator so that it is possible to select an arc on the basis of</span>
<span style="color: #ff0099">  424: </span>    <span style="color: #000099">// the nodes it is connected to.</span>
<span style="color: #ff0099">  425: </span>
<span style="color: #ff0099">  426: </span>    <span style="color: #000099">// Note: I used a callback because the STL-like predicate idea wasn't working for me...</span>
<span style="color: #ff0099">  427: </span>
<span style="color: #ff0099">  428: </span>    <span style="color: #000099">// test for the existence of a path from from to to</span>
<span style="color: #ff0099">  429: </span>    <span style="color: #990000">bool</span> <span style="color: #000000">path_exists</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  430: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  431: </span>    <span style="color: #990000">bool</span> <span style="color: #000000">path_exists</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  432: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  433: </span>
<span style="color: #ff0099">  434: </span>    <span style="color: #000099">// get the set of all paths from from to to</span>
<span style="color: #ff0099">  435: </span>    <span style="color: #000000">const_path_vector</span> <span style="color: #000000">all_paths</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  436: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  437: </span>    <span style="color: #000000">path_vector</span> <span style="color: #000000">all_paths</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  438: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  439: </span>
<span style="color: #ff0099">  440: </span>    <span style="color: #000099">// get the set of all nodes that can be reached by any path from from</span>
<span style="color: #ff0099">  441: </span>    <span style="color: #000000">const_node_vector</span> <span style="color: #000000">reachable_nodes</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  442: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  443: </span>    <span style="color: #000000">node_vector</span> <span style="color: #000000">reachable_nodes</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  444: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  445: </span>
<span style="color: #ff0099">  446: </span>    <span style="color: #000099">// get the set of all nodes that can reach to to by any path</span>
<span style="color: #ff0099">  447: </span>    <span style="color: #000000">const_node_vector</span> <span style="color: #000000">reaching_nodes</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  448: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  449: </span>    <span style="color: #000000">node_vector</span> <span style="color: #000000">reaching_nodes</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  450: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  451: </span>
<span style="color: #ff0099">  452: </span>    <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  453: </span>    <span style="color: #000099">// Unweighted Shortest path algorithms</span>
<span style="color: #ff0099">  454: </span>
<span style="color: #ff0099">  455: </span>    <span style="color: #000099">// find the shortest path from from to to</span>
<span style="color: #ff0099">  456: </span>    <span style="color: #000099">// This is an unweighted shortest path algorithm, i.e. the weight of each</span>
<span style="color: #ff0099">  457: </span>    <span style="color: #000099">// arc is assumed to be 1, so just counts the number of arcs</span>
<span style="color: #ff0099">  458: </span>    <span style="color: #000099">// if there is more than one shortest path it returns the first one</span>
<span style="color: #ff0099">  459: </span>    <span style="color: #000099">// If there are no paths, returns an empty path</span>
<span style="color: #ff0099">  460: </span>    <span style="color: #000000">const_arc_vector</span> <span style="color: #000000">shortest_path</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  461: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  462: </span>    <span style="color: #000000">arc_vector</span> <span style="color: #000000">shortest_path</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  463: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  464: </span>
<span style="color: #ff0099">  465: </span>    <span style="color: #000099">// find the set of shortest paths from from to any other node in the graph</span>
<span style="color: #ff0099">  466: </span>    <span style="color: #000099">// that is reachable (i.e. for which path_exists() is true)</span>
<span style="color: #ff0099">  467: </span>    <span style="color: #000099">// This is an unweighted shortest path, so just counts the number of arcs</span>
<span style="color: #ff0099">  468: </span>    <span style="color: #000099">// if there is more than one shortest path to a node it returns the first one</span>
<span style="color: #ff0099">  469: </span>    <span style="color: #000099">// If there are no paths, returns an empty list</span>
<span style="color: #ff0099">  470: </span>    <span style="color: #000000">const_path_vector</span> <span style="color: #000000">shortest_paths</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  471: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  472: </span>    <span style="color: #000000">path_vector</span> <span style="color: #000000">shortest_paths</span><span style="color: #330033">(</span><span style="color: #000000">iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span>
<span style="color: #ff0099">  473: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  474: </span>
<span style="color: #ff0099">  475: </span>  <span style="color: #990000">private</span><span style="color: #330033">:</span>
<span style="color: #ff0099">  476: </span>    <span style="color: #990000">friend</span> <span style="color: #990000">class</span> <span style="color: #000000">digraph_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #000000">NT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #000000">NT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  477: </span>    <span style="color: #990000">friend</span> <span style="color: #990000">class</span> <span style="color: #000000">digraph_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #990000">const</span> <span style="color: #000000">NT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #990000">const</span> <span style="color: #000000">NT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  478: </span>    <span style="color: #990000">friend</span> <span style="color: #990000">class</span> <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  479: </span>    <span style="color: #990000">friend</span> <span style="color: #990000">class</span> <span style="color: #000000">digraph_arc_iterator</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">,</span><span style="color: #990000">const</span> <span style="color: #000000">AT</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">AT</span><span style="color: #330033">*</span><span style="color: #330033">&gt;</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  480: </span>
<span style="color: #ff0099">  481: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">set</span><span style="color: #330033">&lt;</span><span style="color: #000000">const_iterator</span><span style="color: #330033">&gt;</span> <span style="color: #000000">const_iterator_set</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  482: </span>    <span style="color: #990000">typedef</span> <span style="color: #000000">TYPENAME</span> <span style="color: #000000">const_iterator_set</span><span style="color: #330033">::</span><span style="color: #000000">iterator</span> <span style="color: #000000">const_iterator_set_iterator</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  483: </span>
<span style="color: #ff0099">  484: </span>    <span style="color: #990000">bool</span> <span style="color: #000000">path_exists_r</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator_set</span><span style="color: #330033">&amp;</span> <span style="color: #000000">visited</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  485: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  486: </span>
<span style="color: #ff0099">  487: </span>    <span style="color: #990000">void</span> <span style="color: #000000">all_paths_r</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">const_arc_vector</span><span style="color: #330033">&amp;</span> <span style="color: #000000">so_far</span><span style="color: #330033">,</span> <span style="color: #000000">const_path_vector</span><span style="color: #330033">&amp;</span> <span style="color: #000000">result</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  488: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  489: </span>
<span style="color: #ff0099">  490: </span>    <span style="color: #990000">void</span> <span style="color: #000000">reachable_nodes_r</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">from</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator_set</span><span style="color: #330033">&amp;</span> <span style="color: #000000">visited</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  491: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  492: </span>
<span style="color: #ff0099">  493: </span>    <span style="color: #990000">void</span> <span style="color: #000000">reaching_nodes_r</span><span style="color: #330033">(</span><span style="color: #000000">const_iterator</span> <span style="color: #000000">to</span><span style="color: #330033">,</span> <span style="color: #000000">const_iterator_set</span><span style="color: #330033">&amp;</span> <span style="color: #000000">visited</span><span style="color: #330033">,</span> <span style="color: #000000">arc_select_fn</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
<span style="color: #ff0099">  494: </span>      <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">wrong_object</span><span style="color: #330033">,</span><span style="color: #000000">null_dereference</span><span style="color: #330033">,</span><span style="color: #000000">end_dereference</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  495: </span>
<span style="color: #ff0099">  496: </span>    <span style="color: #000000">digraph_node</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">*</span> <span style="color: #000000">m_nodes_begin</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  497: </span>    <span style="color: #000000">digraph_node</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">*</span> <span style="color: #000000">m_nodes_end</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  498: </span>    <span style="color: #000000">digraph_arc</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">*</span> <span style="color: #000000">m_arcs_begin</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  499: </span>    <span style="color: #000000">digraph_arc</span><span style="color: #330033">&lt;</span><span style="color: #000000">NT</span><span style="color: #330033">,</span><span style="color: #000000">AT</span><span style="color: #330033">&gt;</span><span style="color: #330033">*</span> <span style="color: #000000">m_arcs_end</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  500: </span>  <span style="color: #330033">}</span><span style="color: #330033">;</span>
<span style="color: #ff0099">  501: </span>
<span style="color: #ff0099">  502: </span>  <span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #ff0099">  503: </span>
<span style="color: #ff0099">  504: </span><span style="color: #330033">}</span> <span style="color: #000099">// end namespace stlplus</span>
<span style="color: #ff0099">  505: </span>
<span style="color: #ff0099">  506: </span><span style="color: #990000">#include</span> <span style="color: #009900">"digraph.tpp"</span>
<span style="color: #ff0099">  507: </span><span style="color: #990000">#endif</span>
</pre>
</body>
</html>
